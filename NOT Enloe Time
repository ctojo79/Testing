<!DOCTYPE html>
<html>
    <head>
        <title>(Not Really) EnloeTime</title>
        <style>
            :root {
                --text-color: #8e1a00;
                --background-color: #c09b85;
                --accent-color: #4b251e;
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: monospace;
                font-weight: bold;
                color: var(--text-color);
                background-color: var(--background-color);
                width: 100%;
                height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                overflow: hidden;
            }

            #main {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                padding: clamp(10px, 2vh, 20px);
                max-width: 95%;
                text-align: center;
            }

            #time {
                font-size: clamp(40px, 12vmin, 120px);
                white-space: nowrap;
                margin-bottom: clamp(2px, 1vh, 5px);
            }

            #suffix {
                font-size: clamp(20px, 6vmin, 60px);
                white-space: nowrap;
                margin-bottom: clamp(15px, 8vh, 80px);
            }

            #quote {
                font-size: clamp(15px, 5vmin, 40px);
                color: var(--accent-color);
                max-width: 85%;
                line-height: 1.3;
                word-wrap: break-word;
            }
        </style>
    </head>
    <body>
        <div id="main">
            <p id="time">Loading...</p>
            <p id="suffix"></p>
            <p id="quote">Loading...</p>
        </div>
        <script>
            let quotes = null;
            window.onload = () => {
                fetch("./quotes.json").then(r => r.json()).then(r => quotes = r).catch(e => console.error("Quotes failed to load."));
            };

            setInterval(() => {
                let now = new Date();
                let year = now.getFullYear();
                let month = now.getMonth();
                let day = now.getDate();
                let blocks = [
                    {date: new Date(year, month, day, 7, 25), suffix: "before school"},
                    {date: new Date(year, month, day, 8, 52), suffix: "of 1st Period"},
                    {date: new Date(year, month, day, 10, 35), suffix: "of 2nd Period"},
                    {date: new Date(year, month, day, 11, 16), suffix: "of Lunch"},
                    {date: new Date(year, month, day, 12, 47), suffix: "of 3rd Period"},
                    {date: new Date(year, month, day, 14, 20), suffix: "of 4th Period"},
                    {date: new Date(year, month, day + 1, 7, 25), suffix: "before school"}
                ];

                let next = blocks.find(r => r.date > now);
                let diff = next.date - now;
                diff = Math.floor(diff / 1000);

                let secs = diff % 60;
                diff = Math.floor(diff / 60);
                let mins = diff % 60;
                diff = Math.floor(diff / 60);
                let hrs = diff;

                let timestr = `${hrs === 0 ? "" : hrs.toString().padStart(2, '0') + ":"}${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2, '0')}`;

                document.getElementById("time").innerText = timestr;
                document.getElementById("suffix").innerText = `left ${next.suffix}`;
                
                if (quotes !== null) {
                    let wrapped = Math.floor(new Date().setHours(0,0,0,0) / 1000 / 86400) % quotes.length;
                    document.getElementById("quote").innerText = `"${quotes[wrapped]}"`;
                } else document.getElementById("quote").innerText = "";

                document.title = timestr;
            }, 200);
        </script>
    </body>
</html>
